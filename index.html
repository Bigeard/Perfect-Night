<!doctypehtml><html><head><meta charset=utf-8><meta content="text/html; charset=utf-8"http-equiv=Content-Type><title>Perfect Night</title><meta content="Perfect Night"name=title><meta content="Multi Player Video Game | Perfect Night"name=description><meta content="perfectnight, multiplayer, videogame"name=keywords><meta content="width=device-width"name=viewport><link href=/favicon.ico rel="shortcut icon"><script src=js/peerjs.min.js></script><script src=js/qrenc3.min.js></script><script src=js/virtualgamepad.js></script><style>html{background:#000}body{margin:0;display:flex;align-items:center;justify-content:center;height:100vh}canvas{width:100%}#peerjs{display:none;position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);background:#cdcdcd;padding:15px;border-radius:10px;border:double 3px #000;width:60%;height:60%;justify-content:space-around}.message-container{width:100%}.info-container{width:100%}</style></head><body><canvas id=canvas oncontextmenu=event.preventDefault() tabindex=-1></canvas><div id=peerjs><div class=message-container><span>Messages:<span id=message></span></span><input id=sendMessageBox placeholder="Enter a message..."></div><div class=info-container><span>Status:<span id=status></span></span><div style=font-weight:700 title="Copy this ID to the input on send.html.">ID: <input id=receiverId disabled><button onclick=copyToClipboard()>Copy ID</button><canvas id=qrcanv></canvas></div></div></div><script>var Module={canvas:document.getElementById("canvas")},peerjs=document.getElementById("peerjs");togglePeerJs=()=>("flex"===peerjs.style.display?peerjs.style.display="none":peerjs.style.display="flex",1),(()=>{setupqr(),copyToClipboard=()=>{a.select(),navigator.clipboard.writeText(a.value)};var e=null,n=null,s=null,o=document.getElementById("status"),t=(document.getElementById("message"),document.getElementById("sendMessageBox")),a=document.getElementById("receiverId");t.addEventListener("keypress",(e=>{if("13"===e.keyCode)if(s&&s.open){var n=t.value;t.value="",s.send(n),addMessage('<span class="selfMsg">Self: </span>'+n)}else console.error("Connection is closed")})),(n=new Peer(null,{debug:2})).on("open",(s=>{null===n.id?(console.log("Received null id from peer open"),n.id=e):e=n.id,a.value=n.id,console.log(window.location.href+"g.htm?i="+n.id),doqr(window.location.href+"g.htm?i="+n.id),o.innerHTML="Awaiting connection..."})),n.on("connection",(e=>{if(listGamepad.size>=4)return void e.on("open",(()=>{e.send("Error: To many players"),setTimeout((()=>e.close()),500)}));s=e;const n=new VirtualGamepad(s,s.peer,listGamepad.size);listGamepad.set(n.id,n);const t=listGamepad.forEach((e=>e.name+" | "));o.innerHTML="Connected to: "+t})),n.on("disconnected",(()=>{o.innerHTML="Connection lost. Please reconnect",n.id=e,n._lastServerId=e,listGamepad.get(n.id).disconnect(),n.reconnect()})),n.on("close",(()=>{listGamepad.forEach((e=>e.disconnect())),o.innerHTML="Connection destroyed. Please refresh"})),n.on("error",(e=>alert(""+e)))})();const addMessage=e=>{var n=new Date,s=n.getHours();const o=e=>(e<10&&(e="0"+e),e);var t=o(n.getMinutes()),a=o(n.getSeconds());s>12?s-=12:0===s&&(s=12),message.innerHTML='<br><span class="msg-time">'+s+":"+t+":"+a+"</span>  -  "+e+message.innerHTML}</script><script src=index.js async></script></body></html>