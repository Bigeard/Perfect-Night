<!doctypehtml><html><head><meta charset=utf-8><meta content="text/html; charset=utf-8"http-equiv=Content-Type><title>Perfect Night</title><meta content="Perfect Night"name=title><meta content="Multi Player Video Game | Perfect Night"name=description><meta content="perfectnight, multiplayer, videogame"name=keywords><meta content="width=device-width"name=viewport><link href=/favicon.ico rel="shortcut icon"><script src=js/peerjs.min.js></script><script src=js/qrenc3.min.js></script><script src=js/virtualgamepad.js></script><style>html{background:#000}body{margin:0;display:flex;align-items:center;justify-content:center;height:100vh}canvas{width:100%}#peerjs{display:none;position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);background:#cdcdcd;padding:15px;border-radius:10px;border:double 3px #000;width:60%;height:60%;justify-content:space-around}.message-container{width:100%}.info-container{width:100%}</style></head><body><canvas id=canvas oncontextmenu=event.preventDefault() tabindex=-1></canvas><div id=peerjs><div class=message-container><span>Messages:<span id=message></span></span><input id=sendMessageBox placeholder="Enter a message..."></div><div class=info-container><span>Status:<span id=status></span></span><div style=font-weight:700 title="Copy this ID to the input on send.html.">ID: <input id=receiverId disabled><button onclick=copyToClipboard()>Copy ID</button><canvas id=qrcanv></canvas></div></div></div><script>var Module={canvas:document.getElementById("canvas")},peerjs=document.getElementById("peerjs");togglePeerJs=()=>("flex"===peerjs.style.display?peerjs.style.display="none":peerjs.style.display="flex",1),(()=>{setupqr(),copyToClipboard=()=>{l.select(),navigator.clipboard.writeText(l.value)};var e=null,n=null,o=null,t=document.getElementById("status"),a=document.getElementById("message"),s=document.getElementById("sendMessageBox"),l=document.getElementById("receiverId");const r=()=>{o.on("data",(e=>{null==e||"object"!=typeof e&&"function"!=typeof e?d('<span class="peerMsg">Peer: </span>'+e):(console.log(e),"l"===e.j?(virtualGamepad.Gamepad.axes[0]=e.x,virtualGamepad.Gamepad.axes[1]=e.y):(virtualGamepad.Gamepad.axes[2]=e.x,virtualGamepad.Gamepad.axes[3]=e.y))})),o.on("close",(()=>{t.innerHTML="Connection reset<br>Awaiting connection...",o=null}))},d=e=>{var n=new Date,o=n.getHours();const t=e=>(e<10&&(e="0"+e),e);var s=t(n.getMinutes()),l=t(n.getSeconds());o>12?o-=12:0===o&&(o=12),a.innerHTML='<br><span class="msg-time">'+o+":"+s+":"+l+"</span>  -  "+e+a.innerHTML};s.addEventListener("keypress",(e=>{if("13"===e.keyCode)if(o&&o.open){var n=s.value;s.value="",o.send(n),d('<span class="selfMsg">Self: </span>'+n)}else console.error("Connection is closed")})),(n=new Peer(null,{debug:2})).on("open",(o=>{null===n.id?(console.log("Received null id from peer open"),n.id=e):e=n.id,l.value=n.id,doqr(window.location.href+"g.htm?i="+n.id),t.innerHTML="Awaiting connection..."})),n.on("connection",(e=>{o&&o.open?e.on("open",(()=>{e.send("Already connected to another client"),setTimeout((()=>e.close()),500)})):(o=e,t.innerHTML="Connected to: "+o.peer,virtualGamepad.connect(o.peer),r())})),n.on("disconnected",(()=>{t.innerHTML="Connection lost. Please reconnect",n.id=e,n._lastServerId=e,virtualGamepad.disconnect(),n.reconnect()})),n.on("close",(()=>{o=null,t.innerHTML="Connection destroyed. Please refresh"})),n.on("error",(e=>alert(""+e)))})()</script><script src=index.js async></script></body></html>